<h1><b>Система персонализированного здравоохранения на основе IoT и ML</b></h1>
<br>
<h3><b>Проблема:</b> Реактивный подход в современной медицине не позволяет предотвращать заболевания</h3>
<h3><b>ML-задача:</b> Разработка системы предиктивной аналитики здоровья на основе данных носимых устройств, экологических факторов и медицинской истории</h3>
<h3><b>Данные:</b> Данные с носимых медицинских устройств, данные о качестве воздуха и воды, электронные медицинские карты</h3>
<br>
<h1>Разработка сервисов машинного обучения согласно методологии на основе стандарта CRISP-DM.</h1>

<h2>1.  Бизнес-анализ (Business Understanding)</h2>
Определимся с целями и скоупом проекта.<br>
<br>
<h3>Организационная структура:</h3><br>
<h4>Участники со стороны заказчика:</h4>
* Руководство медучреждения: Генеральный директор или главный врач.<br>
* IT-отдел: Специалисты по информационным технологиям, отвечающие за внедрение и поддержку системы.<br>
* Медицинские эксперты: Врачи-консультанты, участвующие в разработке клинических сценариев и оценке эффективности системы.<br>
* Административные сотрудники: Отдел кадров, бухгалтерия, обеспечивающие ресурсную поддержку проекта.<br>
<h4>Основные пользователи:</h4><br>
* Пациенты: Получают рекомендации по поддержанию здоровья и предупреждения заболеваний.<br>
* Врачи: Используют систему для мониторинга состояния пациентов и принятия профилактических мер.<br>
* Медсестры и младший медицинский персонал: Помогают пациентам с использованием носимых устройств и интерпретацией данных.<br>
* Управленческий персонал: Анализирует общие тенденции здоровья населения и эффективность профилактических мероприятий.<br>
>>> Таким образом, основными пользователями системы станут врачи, медсестры и пациенты медицинских организаций, тогда как руководство и IT-отдел будут отвечать за внедрение и поддержание работы системы.

<h3>Собираем контакты, создаем рабочие чаты (Создание рабочих чатов и распределение контактов)</h3><br>
Учитывая разнообразие заказчиков и необходимость обеспечения конфиденциальности, рекомендуется организовать работу следующим образом:<br>
<br>
<h4>Создание секретных чатов в Telegram:</h4>
* Каждый заказчик получает отдельный секретный чат, чтобы обеспечить защиту данных и конфиденциальность общения.<br>
* Чат создается исключительно для общения с представителями конкретного заказчика, исключая доступ посторонних лиц.<br>
<h4>Распределение участников по чатам:</h4>
* <b>Чисто медицинские организации:</b> В одном чате объединяются представители медицинских учреждений, занимающихся непосредственно лечением и профилактикой заболеваний.<br>
* <b>Государственные структуры:</b> Отдельный чат для представителей государственных органов, участвующих в финансировании или регулировании здравоохранения.<br>
* <b>Коммерческие компании:</b> Чат для компаний, предлагающих коммерческие услуги в области здравоохранения, такие как фармацевтические фирмы или поставщики медицинского оборудования.<br>
* <b>Иностранные заказчики:</b> Создается специальный чат для зарубежных партнеров, учитывая особенности международного сотрудничества и законодательства.<br>
* <b>Страховые компании:</b> Отдельный чат для страховщиков, интересующихся системами предиктивной аналитики для оптимизации страховых выплат и управления рисками.<br>
<h4>Управление контактами:</h4>
* Все контактные данные заказчиков сохраняются в защищенной базе данных или CRM-системе.<br>
* Назначается ответственный сотрудник, который контролирует добавление новых участников в соответствующие чаты и удаление устаревших контактов.<br>
<h4>Безопасность и конфиденциальность:</h4>
* Использование шифрования сообщений в Telegram обеспечивает высокий уровень защиты данных.<br>
* Регулярные проверки прав доступа и обновление списка участников помогут поддерживать безопасность на высоком уровне.<br>
>>> Такое структурированное распределение контактов позволит эффективно управлять коммуникациями, обеспечивая конфиденциальность и оперативность взаимодействия с каждым заказчиком.

<h4>Какова бизнес-цель проекта?</h4>
Бизнес-цель проекта заключается в создании эффективной системы предиктивной аналитики здоровья, которая позволит медицинским организациям и пациентам перейти от реактивного подхода к медицине к проактивному управлению здоровьем. Это поможет предотвратить развитие заболеваний, снизить затраты на лечение и повысить общее благополучие населения.

<h4>Существуют ли какие-то уже разработанные решения? Если существуют, то какие и чем именно текущее решение не устраивает?</h4>
* Существует ряд решений в области предиктивной аналитики здоровья, использующих технологии IoT и машинное обучение. Примером являются платформы для мониторинга состояния здоровья, такие как Fitbit и Apple Health, а также специализированные медицинские приложения, анализирующие данные с носимых устройств. В России активно развиваются цифровые решения в сфере здравоохранения, такие как система телемедицины от «Ростеха», онлайн-консультации и отслеживание показателей здоровья от «СберЗдоровья», а также решения для умных городов от «МТТ». В рамках программы цифровизации здравоохранения в России создаются единые государственные информационные системы (ЕГИСЗ), включая сервисы электронной регистратуры и «Поликлиника Онлайн».<br>
* Также существует российский медицинский стартап, под эгидой Сколково, который разработал аналитику для получения анамнеза из электронных медицинских карт. Решение основано на загрузке электронной медицинской карты в графовую базу данных Neo4j , сбора анамнеза, проведении предиктивной аналитики, рекомендаций. Система не имеет проблемы “холодного старта”, работает с минимальной стартовой загрузки и чем больше информации загружается, тем умнее становится система, отслеживая и классифицируя загружаемый контент из электронных медицинских карт.  Этот инструмент помогает врачам быстрее получать необходимую информацию о пациенте, однако для усиления взаимодействия врача и пациента и ускорения отклика требуется дальнейшее совершенствование. Необходимо соблюдать этику данных, и IT-продукты могут лишь рекомендовать врачу или пациенту действия для поддержания здоровья, оставляя принятие решений за человеком.<br>
* Есть специализированные чаты в Telegram, где обсуждаются вопросы цифрового здравоохранения, что способствует обмену опытом и идеями в этой области.<br>


<h2><b>1.1 Текущая ситуация (Assessing current solution)</b></h2>
<h3>Оцениваем, хватает ли ресурсов для проекта.</h3>
* <b>Есть ли доступное железо или его необходимо закупать?</b><br> 
На данный момент используется yandex.cloud для работы с git’ом, для разворачивания систем на виртуальных машинах. Столкнулись с тем, что для задач рекомендации или классификации желательно перейти на собственные ресурсы. Для рекомендаций, анализа медицинского анамнеза, запрашивается много эмбеддингов и RAG-запросов. Экономически выгодно будет перейти на собственные ресурсы со временем. Особенно при масштабировании проекта и увеличении количества внешних данных.<br>
* <b>Где и как хранятся данные, будет ли предоставлен доступ в эти системы, нужно ли дополнительно докупать/собирать?</b><br>
Данные по медицинской электронной карте аккумулируются в графовую базу данных Neo4j. Также для сохранения данных предусмотрены таблицы Postgres в Django. Для разворачивания системы используется S3 от Yandex Cloud (для разработчиков). Доступ к загрузке и к обработанным данным со стороны заказчика происходит с помощью API и личного кабинета.<br>
* <b>Внешние данные?</b><br>
Основным источником данных для наполнения графовой базы данных служат деперсонализированные медицинские данные от заказчиков. Используются дополнительные конвертеры данных. Обычно у заказчиков развёрнута медицинская информационная система (МИС). Усилиями IT-специалистов заказчика или IT-специалистов подрядчика по договорённости и специфики идёт разработка конвертора данных под API разрабатываемого проекта.
<br>
<br>
<h4>Передача данных с носимых медицинских устройств</h4>
* <b>Сбор данных:</b> Носимые медицинские устройства (например, фитнес-трекеры, смарт-часы, датчики ЭКГ) собирают данные о состоянии организма, такие как частота пульса, уровень кислорода в крови, физическая активность и другие показатели.<br>
* <b>Передача данных:</b> Данные передаются через беспроводные протоколы, такие как Bluetooth Low Energy (BLE) или Wi-Fi, на мобильное устройство пользователя (смартфон или планшет). Некоторые устройства могут передавать данные напрямую в облачные сервисы через сотовую связь (если поддерживают подключение к сети).<br>
* <b>Обработка и хранение:</b> На мобильном устройстве данные обрабатываются приложением, после чего они отправляются в облачное хранилище для дальнейшего анализа и хранения. Здесь же могут применяться алгоритмы предварительной обработки данных.<br>
<br>
<br>
<h4>Передача данных о качестве воздуха и воды</h4>
* <b>Сбор данных:</b> Датчики качества воздуха и воды устанавливаются в определенных местах (городских районах, вблизи водоемов и т.д.) и измеряют уровни загрязнителей, температуру, влажность и другие параметры.<br>
* <b>Передача данных:</b> Эти данные передаются через проводные или беспроводные сети (Wi-Fi, LTE, LoRaWAN) на серверы сбора данных. Часто используется концепция интернета вещей (IoT), когда сенсоры подключены к сетям с низким энергопотреблением и передают данные периодически.<br>
* <b>Агрегация и обработка:</b> Собранные данные агрегируются на центральном сервере, где они очищаются, нормализуются и готовятся для дальнейшей аналитики.<br>
<br>
<br>
<h4>Внешние данные</h4>
Внешние данные — это любые данные, которые поступают извне основной системы и дополняют информацию, собранную внутри нее. В контексте нашего проекта внешними данными могут быть:<br>
* <b>Данные о погодных условиях:</b> Температура, давление, влажность, скорость ветра и другие метеорологические параметры.<br>
* <b>Социально-экономические данные:</b> Уровень доходов, образование, занятость и другие демографические характеристики.<br>
* <b>Географическая информация:</b> Местоположение пациента, доступность медицинских услуг, плотность населения и пр.<br>
* <b>Научные исследования и публикации:</b> Статистические данные и научные выводы, касающиеся здоровья и факторов риска.<br>
>>> Эти данные важны для построения более точной картины здоровья пациента, учета влияния внешней среды и социальных условий на его состояние.

<h4>Сможет ли заказчик выделить своих экспертов для консультаций на данный проект?</h4>
* Да. Сейчас происходит сотрудничество в рамках пилотных проектов, ведутся ВКС и консультации с представителями врачей, IT-специальностей, руководства.<br>
<br>

Опишем вероятные риски проекта и определим план действий по их уменьшению.

Типичные риски следующие.<br>
* <b>Не уложиться в сроки.</b><br>
Возможно возникновение задержек из-за недооценки сложности задачи, изменения требований, непредвиденных технических проблем или недостатка координации между членами команды. (Тот же YandexCloud был недавно “обесточен” на некоторое время или сталкивались с тем, что доступ к Docker’у был закрыт) Поэтому проект обладает, как собственными разработками, так и пользуется открытыми источниками.
* <b>Малое количество или плохое качество данных, которые не позволяют получить эффективную модель.</b><br>
Неправильная работа датчиков, ошибки в передаче данных или сбои в инфраструктуре могут повлиять на надежность и точность собираемой информации. Соответственно надо предусмотреть возможность оценивания нестабильной работы медицинской аппаратуры, согласно выходным данным.
* <b>Данные качественные, но закономерности в принципе отсутствуют и, как следствие, полученные результаты не интересны заказчику.</b><br>
Здесь нужно учитывать специфику узкого поддомена конкретного заказчика и как следствие тюнить модели. Для детской поликлиники один подход, для хирургии другое. Везде своя специфика, которая не влияет на качество конечной модели, но потребует корректировать время разработки.
* <b>Сопротивление изменениям:</b><br>
Медицинское сообщество может медленно принимать инновации, замедляя внедрение.
* <b>Кибербезопасность:</b><br>
Угрозы утечек данных могут нанести ущерб проекту и подорвать доверие к нему.

<h2><b>1.2 Решаемые задачи с точки зрения аналитики (Data Mining goals)</b></h2>
Выполняем постановку в технических терминах. Для этого нужно ответить на следующие вопросы:

<h4>Метрики для оценки результатов моделирования</h4>
<h5>Носимые медицинские устройства:</h5>
* Accuracy (Точность) – оценивает долю правильно классифицированных случаев относительно общего числа наблюдений.<br>
* Precision (Точность) – показывает долю истинноположительных результатов среди всех положительных предсказаний модели.<br>
* Recall (Полнота) – определяет долю истинноположительных результатов, которые были правильно идентифицированы моделью.<br>
* F1 Score (F-мера) – гармоническое среднее между точностью и полнотой, балансирующее обе метрики.<br>
* ROC-AUC (Площадь под кривой ROC) – измеряет способность модели различать классы, подходит для несбалансированных наборов данных.<br>
<h5>Данные о качестве воздуха и воды:</h5>
* MAE (Средняя абсолютная ошибка) – средняя величина отклонения предсказанных значений от фактических.<br>
* RMSE (Корень среднеквадратичной ошибки) – квадратичный аналог MAE, чувствителен к большим отклонениям.<br>
* R² (Коэффициент детерминации) – показатель степени соответствия модели данным, варьирующийся от 0 до 1.<br>
* MAPE (Средняя процентная ошибка) – относительная мера ошибки, полезная для сравнения прогнозируемых величин.<br>
<h5>Получение анамнеза с электронных медицинских карт:</h5>
* LogLoss (Логарифмическая потеря) – оценка вероятности ошибок классификации, широко используемая в логистической регрессии.<br>
* Confusion Matrix (Матрица путаницы) – таблица, показывающая количество правильных и неправильных предсказаний для каждого класса.<br>
* MCC (Коэффициент Маттео) – учитывает сбалансированность классов и является предпочтительной метрикой для небольших выборок.<br>
* Sensitivity (Чувствительность) – доля верно классифицированных положительных случаев среди всех положительных.<br>
* Specificity (Специфичность) – доля верно классифицированных отрицательных случаев среди всех отрицательных.<br>
---
<h6>Носимые медицинские устройства:</h6>
<h6>Характерные значения для метрик:</h6>
Accuracy: >90%<br>
Precision: >85%<br>
Recall: >80%<br>
F1 Score: >0.8<br>
ROC-AUC: >0.75<br>
<b>Оценка без объективного критерия:</b>
Оценка качества модели может основываться на субъективных мнениях врачей и пациентов, которые используют систему. Можно проводить опросы, собирать обратную связь и сравнивать результаты с ожиданиями пользователей.
<h6>Данные о качестве воздуха и воды:</h6>
<h6>Характерные значения для метрик:</h6>
MAE: <5% от среднего значения показателя<br>
RMSE: <10% от стандартного отклонения<br>
R²: >0.8<br>
MAPE: <10%<br>
<b>Оценка без объективного критерия:</b>
Результаты можно оценивать по тому, насколько точно они отражают реальные изменения в окружающей среде. Для этого можно использовать сравнение с историческими данными или независимыми источниками измерений.
<h6>Получение анамнеза с электронных медицинских карт:</h6>
<h6>Характерные значения для метрик:</h6>
LogLoss: <0.2<br>
MCC: >0.6<br>
Sensitivity: >85%<br>
Specificity: >80%<br>
<b>Оценка без объективного критерия:</b>
Качество модели можно оценивать через клиническую значимость полученных выводов. Например, насколько хорошо модель помогает врачам принимать решения и улучшать диагностику и лечение пациентов.<br>
>>> Нужно в рамках проекта сконцентрироваться на решение одной из задач. Как вариант - следить за индексом здоровья пациента на базе данных по загрязнению воздуха. Это будет дополнительный фактор для классификации связей в графовой базе данных. Анамнез это исторические данные заболевания (стадии заболевания), где один из параметров классифицирован, как опасный. А индекс здоровья меняет отношение к пациенту, изменяя фактор риска заболевания конкретным типом заболевания. То есть для группы пациентов, у которых индекс здоровья ниже, должно быть больше выдачи анамнеза для характерных заболеваний. Также индекс здоровья важный показатель в сфере страховой медицины. Можно обучить модель по параметрам, а параметры брать из графовой базы Neo4j. В базе предусмотрены классы, которые описывают антропометрические, демографические данные человека. А уже по ИМТ, географической локации и другим признакам, можно оценить индекс здоровья пациента, факторы риска заболеваний.
Также важно, что наряду с конверсией в деньги происходит скоррелировано конверсия и в здоровье.

<h2><b>1.3 План проекта (Project Plan)</b></h2>
<h3>Фазы внедрения (на основе стандарта <b>CRISP-DM</b>):</h3>
* <b>Бизнес-анализ (Business Understanding):</b> Анализ бизнес-требований и сбор данных (1 неделя или согласно  графика обучения).<br>
* <b>Анализ-данных (Data Understanding):</b> Критическая оценка внешних данных: источников, достоверности, целостности (1 неделя или согласно  графика обучения).<br>
* <b>Подготовка данных (Data Preparation):</b> Очистка, преобразование и интеграция данных (3 недели или согласно  графика обучения).<br>
* <b>Моделирование (Modeling):</b> Создание и тестирование моделей (4 недели или согласно  графика обучения).<br>
* <b>Оценка результата (Evaluation):</b> Выбор наилучшей модели и оценка её эффективности (2 недели или согласно  графика обучения). Возможен пересмотр бизнес-задачи с повторным проведением предыдущих пунктов с учетом предложенных корректировок.<br>
* <b>Внедрение (Deployment:</b> Интеграция модели в существующие процессы (3 недели или согласно  графика обучения).<br>
* <b>Мониторинг и поддержка:</b> Постоянный мониторинг и улучшение модели (непрерывно).<br>
